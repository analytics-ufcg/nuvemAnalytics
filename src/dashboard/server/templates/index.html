<!DOCTYPE html style="height:100%;">
<head>
<meta charset="utf-8">
	<title>Nuvem Dashboard</title>
	<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/nuvem_style.css')}}">
	<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/bootstrap.min.css')}}">
	<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/datepicker.css')}}">
	<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/bootstrap-timepicker.min.css')}}">
</meta>
</head>
<body style="height:100%;">
	<div class='container-fluid' style="height:100%;">
		<div class='row-fluid' style="height:10%;" id='top_bar'>
			(mockup) title
		</div>
		<div class='row-fluid' style="height:85%;">
			<div style="width:10%; height:100%; float:left;" id='sidebar'>
				<div class='row-fluid' style="height:40%;" id='time_bar'>
					<em> Pick a <strong>start</strong> date and time:</em>
					<div id="start_date_time">
						<div class="input-append date" id="start_date_wrapper" style="float:left; width:50%;" data-date="12-02-2012" data-date-format="dd-mm-yyyy">
							<input id="start_date" class="input-block-level" type="text" value="12-02-2012">
							<span class="add-on"><i class="icon-calendar"></i></span>
						</div>
						<div class="bootstrap-timepicker" id="start_time_wrapper" style="float:right; width:38%;">
							<input id="start_time" class="input-block-level" type="text">
						</div>
					</div>
					<br/>
					<em> Pick an <strong>end</strong> date and time:</em>
					<div id="end_date_time">
						<div class="input-append date" id="end_date_wrapper" style="float:left; width:50%;" data-date="12-02-2012" data-date-format="dd-mm-yyyy">
							<input id="end_date" class="input-block-level" type="text" value="12-02-2012">
							<span class="add-on"><i class="icon-calendar"></i></span>
						</div>
						<div class="bootstrap-timepicker" id="end_time_wrapper" style="float:right; width:38%;">
							<input id="end_time" class="input-block-level" type="text">
						</div>
					</div>
				</div>
				<div class='row-fluid' style="height:30%;" id='query_type_bar'>
					(mockup) <br/>Query Type: <ul><li>subutilization</li> <li>superutilization</li> <li>prediction</li></ul>
				</div>
				<div class='row-fluid' style="height:30%;" id='query_view_bar'>
					(mockup) <br/>Query Visualization Type: <ul><li>agreggated queries</li> <li>not agreggated queries</li></ul>
				</div>
			</div>
			<div style="width:40%; height:100%; padding:0px; float:left;" id='bubble_chart'>
				{% for message in get_flashed_messages() %}
				<div class='alert alert-error' style="width:91%;">
					<button type='button' class='close' data-dismiss='alert'>&times;</button>
					{{ message }}
				</div>
				{% endfor %}
			</div>
			<div style="width:50%; padding:0px; float:left;">
				<div class='row' id='chart2' style="height:50%;">
					(mockup)<br/>
					<br/>Chart 2
				</div>
				<div class='row' id='chart3' style="height:50%;">
					(mockup)<br/>
					<br/>Chart 3
				</div>
			</div>
		</div>
		<div class='row-fluid' style="height:5%;" id='bottom_bar'>
			(mockup) copyright and other info space
		</div>
	</div>
	<script src="{{url_for('static', filename='js/jquery-1.10.1.min.js')}}"></script>
	<script src="{{url_for('static', filename='js/d3.v3.min.js')}}"></script>
	<script src="{{url_for('static', filename='js/bubble_chart.js')}}"></script>
	<script src="{{url_for('static', filename='js/bootstrap.js')}}"></script>
	<script src="{{url_for('static', filename='js/bootstrap-datepicker.js')}}"></script>
	<script src="{{url_for('static', filename='js/bootstrap-timepicker.min.js')}}"></script>
	<script type="text/javascript">
	{% if response %}

		var bubble_chart_data;

		$(document).ready(function(){
			bubble_chart_data = JSON.parse({{ response|tojson|safe }})
			showBubbleChart(bubble_chart_data);
		});

	{% endif %}

	var lowerBound = new Date(1950, 1, 1, 0, 0, 0, 0);
	var now = new Date();
	var upperBound = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 0, 0, 0, 0);
	
	var start_field = $("#start_date_wrapper").datepicker({
		onRender : function(date) {
			return date.valueOf() <= lowerBound.valueOf() || date.valueOf() > upperBound.valueOf() ? 'disabled' : '';
		}
	}).on('changeDate', function(ev) {
		if ( ev.date.valueOf() > end_field.date.valueOf() ){
			var newDate = new Date(ev.date);
			newDate.setDate(newDate.getDate() + 1);
			end_field.setValue(newDate);
		}
	}).data('datepicker');

	$("#start_date_wrapper").datepicker('setValue', now);
	$("#start_date").click(function() {
		$("start_date_wrapper").datepicker('show');
	});

	$("#start_time").timepicker({
		showMeridian : false,
		showSeconds : true,
		disableFocus: true,
		showInputs: false,
		minuteStep : 5
	});

	var end_field = $("#end_date_wrapper").datepicker({
		onRender : function(date) {
			return date.valueOf() <= start_field.date.valueOf() || date.valueOf() > upperBound.valueOf() ? 'disabled' : '';
		}
	}).data('datepicker');

	$("#end_date_wrapper").datepicker('setValue', upperBound);
	$("#end_date").click(function() {
		$("end_date_wrapper").datepicker('show');
	});


	$("#end_time").timepicker({
		showMeridian : false,
		showSeconds : true,
		disableFocus: true,
		showInputs: false,
		minuteStep : 5
	});

	</script>
</body>
</html>
